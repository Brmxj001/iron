<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Responsive Admin Dashboard Template">
<meta name="keywords" content="admin,dashboard">
<meta name="author" content="stacks">
<!-- The above 6 meta tags *must* come first in the head; any other head content must come *after* these tags -->

<!-- Title -->
<title>Connect - Responsive Admin Dashboard Template</title>

<!-- Styles -->
<link
	href="https://fonts.googleapis.com/css?family=Lato:400,700,900&display=swap"
	rel="stylesheet">
<link
	href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700&display=swap"
	rel="stylesheet">
<link
	href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
	rel="stylesheet">
<link th:href="@{/plugins/bootstrap/css/bootstrap.min.css}"
	href="../../assets/plugins/bootstrap/css/bootstrap.min.css"
	rel="stylesheet">
<link th:href="@{/plugins/font-awesome/css/all.min.css}"
	href="../../assets/plugins/font-awesome/css/all.min.css"
	rel="stylesheet">
<link th:href="@{/iron/css/iron.css}" rel="stylesheet">
<!-- Theme Styles -->
<link th:href="@{/css/connect.min.css}"
	href="../../assets/css/connect.min.css" rel="stylesheet">
<link th:href="@{/css/admin4.css}" href="../../assets/css/admin4.css"
	rel="stylesheet">
<link th:href="@{/css/dark_theme.css}"
	href="../../assets/css/dark_theme.css" rel="stylesheet">
<link th:href="@{/css/custom.css}" href="../../assets/css/custom.css"
	rel="stylesheet">
<link th:href="@{/iron/css/categories.css}" rel="stylesheet">
<link th:href="@{/iron/css/products.css}" rel="stylesheet">
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
<link th:href="@{/fileinput/fileinput.css}" rel="stylesheet" />
<script th:src="@{/fileinput/fileinput.js}"></script>
<script th:src="@{/fileinput/zh.js}"></script>
<script th:src="@{/plugins/jquery/jquery-3.4.1.min.js}"
	src="../../assets/plugins/jquery/jquery-3.4.1.min.js"></script>
<script th:src="@{/plugins/bootstrap/popper.min.js}"
	src="../../assets/plugins/bootstrap/popper.min.js"></script>
<script th:src="@{/plugins/bootstrap/js/bootstrap.min.js}"
	src="../../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script th:src="@{/plugins/jquery-slimscroll/jquery.slimscroll.min.js}"
	src="../../assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script th:src="@{/plugins/jquery-sparkline/jquery.sparkline.min.js}"
	src="../../assets/plugins/jquery-sparkline/jquery.sparkline.min.js"></script>
<script th:src="@{/plugins/apexcharts/dist/apexcharts.min.js}"
	src="../../assets/plugins/apexcharts/dist/apexcharts.min.js"></script>
<script th:src="@{/plugins/blockui/jquery.blockUI.js}"
	src="../../assets/plugins/blockui/jquery.blockUI.js"></script>
<script th:src="@{/plugins/flot/jquery.flot.min.js}"
	src="../../assets/plugins/flot/jquery.flot.min.js"></script>
<script th:src="@{/plugins/flot/jquery.flot.time.min.js}"
	src="../../assets/plugins/flot/jquery.flot.time.min.js"></script>
<script th:src="@{/plugins/flot/jquery.flot.symbol.min.js}"
	src="../../assets/plugins/flot/jquery.flot.symbol.min.js"></script>
<script th:src="@{/plugins/flot/jquery.flot.resize.min.js}"
	src="../../assets/plugins/flot/jquery.flot.resize.min.js"></script>
<script th:src="@{/plugins/flot/jquery.flot.tooltip.min.js}"
	src="../../assets/plugins/flot/jquery.flot.tooltip.min.js"></script>
<script th:src="@{/js/connect.min.js}"
	src="../../assets/js/connect.min.js"></script>
<script th:src="@{/js/pages/dashboard.js}"
	src="../../assets/js/pages/dashboard.js"></script>
<script src="../../assets/js/pages/mailbox.js"
	th:src="@{/js/pages/mailbox.js}"></script>
</head>
<body>

	<div th:replace="back/include::modal" id="modal"></div>
	<div class='loader'>
		<div class='spinner-grow text-primary' role='status'>
			<span class='sr-only'>Loading...</span>
		</div>
	</div>
	<div class="connect-container align-content-stretch d-flex flex-wrap">
		<div th:replace="back/include::left" id="left"></div>
		<div class="page-container">
			<div class="page-content">
				
				<div class="main-wrapper">
					<div class="row">
						<div class="col-lg-3">
							<div th:replace="back/include::card-list" id="card-list"></div>
						</div>
						<div class="col-lg-9">
							<div class="card">
								<div class="card-body">
									<table class="table table-hover center">
										<thead>
											<th>产品类型</th>
											<th>产品内容</th>
										</thead>
										<tbody>
											<tr>
												<td>名称</td>
												<td><input placeholder="请输入产品名称" id="productName"
													class="form-control" /></td>
												<td><button id="test" class="iron-hidden">test</button></td>
											</tr>
											<tr>
												<td>名称(English)</td>
												<td><input placeholder="请输入产品名称" id="productNameE"
														   class="form-control" /></td>
												<td></td>
											</tr>
											<tr>
												<td>封面</td>
												<td width="60%"> <img alt="" id="ProductCover"/>
													</td>
												<td><a id="ProductCoverAdd">添加</a></td>
											</tr>
											<tr>
												<td>型号</td>
												<td><input placeholder="请输入产品型号" id="productModel"
													class="form-control" /></td>
												<td></td>
											</tr>
											<tr>
												<td>型号(English)</td>
												<td><input placeholder="请输入产品型号" id="productModelE"
														   class="form-control" /></td>
												<td></td>
											</tr>
											<tr>
												<td>描述</td>
												<td colspan="2"><textarea placeholder="请输入产品描述"
														id="productDescribe" class="form-control"></textarea></td>
											</tr>
											<tr>
												<td>描述(English)</td>
												<td colspan="2"><textarea placeholder="请输入产品描述"
																		  id="productDescribeE" class="form-control"></textarea></td>
											</tr>
											<tr>
												<td>简单描述</td>
												<td colspan="2"><textarea placeholder="请输入产品描述"
																		  id="productSimple" class="form-control"></textarea></td>
											</tr>
											<tr>
												<td>简单描述(English)</td>
												<td colspan="2"><textarea placeholder="请输入产品描述"
																		  id="productSimplee" class="form-control"></textarea></td>
											</tr>
											<tr>
												<td>价格(人民币)</td>
												<td><input placeholder="请输入产品价格" id="productPrize"
													class="form-control" /></td>
												<td></td>
											</tr>
											<tr>
												<td>价格(美元)</td>
												<td><input placeholder="请输入美元价格" id="productPrizee"
														   class="form-control" /></td>
												<td></td>
											</tr>
											<tr>
												<td>分类</td>
												<td><select id="proCat" class="form-control">
														<th:block th:each="c:${categories}">
															<option th:attr="data-id=${c.id}">[[${c.name}]]</option>
														</th:block>
												</select></td>
											</tr>
											<tr>
												<td>照片 (<a id="productselect">选择照片</a>)
												</td>
												<td width="78%" colspan="2"><div class="content-img">
														<ul class="content-img-list-add"></ul>
													</div></td>
											</tr>
											<tr>
												<td></td>
												<td></td>
												<td width="20%"><button class="btn btn-info" id="productUpload">提交</button></td>

											</tr>
										</tbody>
									</table>
									<input type="file" id="ProductCoverInput" class="iron-hidden" accept="image/*"/>
									<input type="file" name="file" id="productIMG"
										class="iron-hidden" accept="image/*" />
									<script type="text/javascript" th:inline="javascript">
									var cover = "";
									$("#test").click(function(){
										console.log(cover)
										var page = [[${url}]] + "/back/test"
										var formData = new FormData();
										formData.append("coverFile",cover)
										$.ajax({
										    url: page,
										    type: 'POST',
										    cache: false,
										    data: formData,
										    processData: false,
										    contentType: false,
										    success:function(res){
										    	console.log("成功")
										    }
										})
									})
									// 产品封面
									$("#ProductCoverAdd").click(function(){
										$("#ProductCoverInput").trigger("click")
									})
									$("#ProductCoverInput").change(function(){
										let file = $(this)[0].files[0]
										let src =getsrc(file)
										cover = file
										$("#ProductCover").attr("src",src)
										$("#ProductCoverAdd").html("修改")
									})
									$(".content-img-list-add").on("click",".delete-div-add",function(){
										var iid = $(this).attr("id")
										imgFile.splice(iid)
										imgSrc.splice(iid)
										let imgBox = ".content-img-list-add"
										showImage(imgBox)
										
									})
									var imgFile = [];
									var imgSrc = [];
									$("#productUpload").click(function(){
										let pName = $("#productName").val();
										let pNameE = $("#productNameE").val();
										let pDescribe = $("#productDescribe").val();
										let pDescribeE = $("#productDescribeE").val();
										let psimple = $("#productSimple").val();
										let psimplee = $("#productSimplee").val();
										let pPrize = $("#productPrize").val();
										let pPrizee = $("#productPrizee").val();
										let pModel = $("#productModel").val();
										let pModelE = $("#productModelE").val();
										let cid = $('#proCat option:selected').attr("data-id");
										if(pName == "" || pDescribe == "" || pPrize == "" || pModel == "" || cover == ""){
											return alert("不能为空")
										}
										var formData = new FormData();
										formData.append("name",pName)
										formData.append("namee",pNameE)
										formData.append("introduction",pDescribe)
										formData.append("introductione",pDescribeE)
										formData.append("simple",psimple)
										formData.append("simplee",psimplee)
										formData.append("prize",pPrize)
										formData.append("prizee",pPrizee)
										formData.append("model",pModel)
										formData.append("modele",pModelE)
										formData.append("cid",cid)
										formData.append("coverFile",cover)
										$.each(imgFile, function(i, file){
											formData.append('file', file);
								        });
										
										var page = [[${url}]] + "/back/products/addone"
										$.ajax({
										    url: page,
										    type: 'POST',
										    cache: false,
										    data: formData,
										    processData: false,
										    contentType: false,
										    success:function(res){
										    	console.log("成功")
										    }
										})
										confirm("添加成功")
										location.reload();
									})
										
									$("#productselect").click(function(){
										$("#productIMG").trigger("click")
									})
									$("#productIMG").change(function() {
										let file = $(this)[0].files[0]
										if(file.type != 'image/png' && file.type != 'image/jpeg' && file.type != 'image/gif'){
											return alert("图片上传格式不正确");
										}
										let src =getsrc(file)
										imgSrc.push(src)
										imgFile.push(file)
										let imgBox = ".content-img-list-add"
										showImage(imgBox)
									})
									
									function showImage(obj){
										// console.log(imgSrc)
										$(obj).html("");
										for(var a = 0; a < imgSrc.length; a++) {
											var oldBox = $(obj).html();
											$(obj).html(oldBox + '<div class="demo"><img class="hundred" src="'+imgSrc[a]+'" alt=""><div id="'+a+'" class="iron-hidden delete-div-add"><a>删除</a></div></div>');
										}
									}
									$(".products-img-list").on('mouseover','#products-img-hide',function(){
										$(".delete-btn").removeClass('hide');
									});
									// 鼠标离开隐藏删除按钮
									$('#products-img-list-add').on('mouseleave','#products-img-hide',function(){
										$(this).children('a').addClass('hide');
									});
									$(".content-img-list-add").on("mousemove",".demo",function(){
										$(this).find(".delete-div-add").removeClass("iron-hidden")
									})
									$(".content-img-list-add").on("mouseout",".demo",function(){
										$(this).find(".delete-div-add").addClass("iron-hidden")
									})
									$(".content-img-list-add").on("click","img",function(){
												var source = $(this).attr("src")
												  $("#ShowImage_Form").find("#img_show").html("<image src='"+source+"' class='carousel-inner img-responsive img-rounded' />");
											         $("#ShowImage_Form").modal();
												
											})
									</script>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="page-footer">
					<div class="row">
						<div class="col-md-12">
							<span class="footer-text">2020 © <a
								href="/iron/front/index">iron</a></span>
						</div>
					</div>
				</div>
			</div>





		</div>
	</div>
	<div class="mailbox-compose-overlay"></div>
	<div class="mailbox-item-overlay"></div>

	<div th:replace="back/include::showImgModal" id="showImgModal"></div>
	<div th:replace="back/include::ironJS" id="ironJS"></div>

</body>
</html>